<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EnergyAI Manaus - Otimiza√ß√£o Energ√©tica AME</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #2E8B57 0%, #228B22 100%); color: #333; min-height: 100vh; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; color: white; margin-bottom: 30px; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .location-info { background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-bottom: 20px; }
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: rgba(255, 255, 255, 0.95); border-radius: 15px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.3); }
        .meter-reading { text-align: center; background: linear-gradient(45deg, #FF6B35, #F7931E); color: white; border-radius: 15px; padding: 20px; }
        .meter-display { font-size: 2.5rem; font-weight: bold; margin: 15px 0; }
        .tariff-info { background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 10px 0; }
        .tariff-row { display: flex; justify-content: space-between; margin: 5px 0; }
        .input-group { margin: 15px 0; }
        .input-group label { display: block; font-weight: bold; margin-bottom: 5px; }
        .input-group input, .input-group textarea, .input-group select { width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 1rem; }
        .input-group input:focus, .input-group textarea:focus, .input-group select:focus { border-color: #4CAF50; outline: none; }
        .device-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .device-card { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); transition: transform 0.3s ease; border-left: 4px solid #4CAF50; }
        .device-card:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(0,0,0,0.15); }
        .device-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .device-info { display: flex; align-items: center; }
        .device-icon { font-size: 2rem; margin-right: 15px; }
        .device-details { flex-grow: 1; }
        .device-name { font-weight: bold; font-size: 1.1rem; }
        .device-specs { color: #666; font-size: 0.9rem; }
        .power-input { width: 80px; padding: 5px; border: 1px solid #ddd; border-radius: 4px; text-align: center; }
        .hours-input { width: 60px; padding: 5px; border: 1px solid #ddd; border-radius: 4px; text-align: center; }
        .cost-display { background: #e3f2fd; padding: 10px; border-radius: 8px; margin: 10px 0; text-align: center; }
        .daily-cost { font-size: 1.1rem; font-weight: bold; color: #1976d2; }
        .monthly-cost { font-size: 0.9rem; color: #666; }
        .device-status { padding: 5px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; cursor: pointer; }
        .status-on { background: #4CAF50; color: white; }
        .status-off { background: #f44336; color: white; }
        .btn { padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; margin: 5px; transition: all 0.3s ease; }
        .btn-primary { background: #2196F3; color: white; }
        .btn-success { background: #4CAF50; color: white; }
        .btn-danger { background: #f44336; color: white; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .section-card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .cost-breakdown { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
        .cost-item { background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center; }
        .cost-value { font-size: 1.5rem; font-weight: bold; color: #2196F3; }
        .recommendations { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .recommendation-item { background: #e8f5e8; border-left: 4px solid #4CAF50; padding: 15px; margin: 10px 0; border-radius: 0 8px 8px 0; }
        .high-consumption { border-left-color: #f44336 !important; background: #ffebee; }
        .grid-2col { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .daily-record { display: flex; align-items: center; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; }
        .input-actions { display: flex; justify-content: flex-end; gap: 5px; margin-top: 5px; }
        .btn-small { padding: 4px 8px; font-size: 0.8em; margin: 0; }
        .menu-title { font-size: 1.5rem; font-weight: bold; cursor: pointer; display: flex; justify-content: space-between; align-items: center; padding: 15px 25px; background: #f0f0f0; border-radius: 15px; margin-bottom: 10px; }
        .menu-title:hover { background: #e0e0e0; }
        .menu-content { display: none; padding: 10px 0; }
        .menu-icon { transition: transform 0.3s ease; }
        .menu-title.active .menu-icon { transform: rotate(90deg); }

        @media (max-width: 768px) {
            .dashboard { grid-template-columns: 1fr; }
            .device-grid { grid-template-columns: 1fr; }
            .header h1 { font-size: 2rem; }
        }
    </style>
</head>
<body>
    <div class="container" id="content-to-pdf">
        <div class="header">
            <h1>‚ö° EnergyAI Manaus</h1>
            <p>Sistema Inteligente de Monitoramento Energ√©tico - Amazonas</p>
            <div class="location-info">
                <strong>üìç Localiza√ß√£o:</strong> Manaus, AM | <strong>‚ö° Concession√°ria:</strong> Amazonas Energia (AME) | <strong>üå°Ô∏è Clima:</strong> Tropical √ömido
            </div>
        </div>

        <div class="section-card">
            <div class="menu-title" onclick="energyAI.toggleMenu('ownerData')">
                <span>üë§ Dados do Titular da Conta</span>
                <span class="menu-icon">‚ñ∂</span>
            </div>
            <div class="menu-content" id="ownerData">
                <div class="input-group">
                    <label for="ownerName">Nome:</label>
                    <input type="text" id="ownerName" value="ARNOLD SOUZA LIMA">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('ownerName')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('ownerName', 'ARNOLD SOUZA LIMA')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="ownerAddress">Endere√ßo:</label>
                    <input type="text" id="ownerAddress" value="R. MONTE FELIZ, 50 - COL TERRA NOVA, AME 50">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('ownerAddress')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('ownerAddress', 'R. MONTE FELIZ, 50 - COL TERRA NOVA, AME 50')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="ownerCep">CEP:</label>
                    <input type="text" id="ownerCep" value="69.015-603">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('ownerCep')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('ownerCep', '69.015-603')">Corrigir</button>
                    </div>
                </div>
                 <div class="input-group">
                    <label for="ownerCity">Cidade:</label>
                    <input type="text" id="ownerCity" value="MANAUS - AM">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('ownerCity')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('ownerCity', 'MANAUS - AM')">Corrigir</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-card">
            <div class="menu-title" onclick="energyAI.toggleMenu('consumerData')">
                <span>üè† Dados da Unidade Consumidora</span>
                <span class="menu-icon">‚ñ∂</span>
            </div>
            <div class="menu-content" id="consumerData">
                <div class="input-group">
                    <label for="consumerGroup">Grupo:</label>
                    <input type="text" id="consumerGroup" value="GRUPO B">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('consumerGroup')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('consumerGroup', 'GRUPO B')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="consumerSubclass">Subclasse:</label>
                    <input type="text" id="consumerSubclass" value="B1 RESIDENCIAL">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('consumerSubclass')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('consumerSubclass', 'B1 RESIDENCIAL')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="consumerSubgroup">Subgrupo:</label>
                    <input type="text" id="consumerSubgroup" value="RESIDENCIAL">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('consumerSubgroup')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('consumerSubgroup', 'RESIDENCIAL')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="consumerClass">Classe:</label>
                    <input type="text" id="consumerClass" value="RESIDENCIAL NORMAL">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('consumerClass')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('consumerClass', 'RESIDENCIAL NORMAL')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="consumerConnection">Liga√ß√£o:</label>
                    <input type="text" id="consumerConnection" value="BIFASICA">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('consumerConnection')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('consumerConnection', 'BIFASICA')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="meterNumber">N√∫mero do Medidor:</label>
                    <input type="text" id="meterNumber" value="11540255">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('meterNumber')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('meterNumber', '11540255')">Corrigir</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-card">
            <div class="menu-title" onclick="energyAI.toggleMenu('readingData')">
                <span>üóìÔ∏è Dados da Leitura</span>
                <span class="menu-icon">‚ñ∂</span>
            </div>
            <div class="menu-content" id="readingData">
                <div class="input-group">
                    <label for="readingDateAnterior">Leitura Anterior (Data):</label>
                    <input type="date" id="readingDateAnterior" value="2025-07-14">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('readingDateAnterior')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('readingDateAnterior', '2025-07-14')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="readingDateAtual">Leitura Atual (Data):</label>
                    <input type="date" id="readingDateAtual" value="2025-08-13">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('readingDateAtual')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('readingDateAtual', '2025-08-13')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="nextReadingDate">Pr√≥xima Leitura (Data):</label>
                    <input type="date" id="nextReadingDate" value="2025-09-12">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('nextReadingDate')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('nextReadingDate', '2025-09-12')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="daysOfConsumption">Dias de Consumo:</label>
                    <input type="number" id="daysOfConsumption" value="30">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('daysOfConsumption')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('daysOfConsumption', '30')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="emissionDate">Emiss√£o (Data):</label>
                    <input type="date" id="emissionDate" value="2025-08-12">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('emissionDate')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('emissionDate', '2025-08-12')">Corrigir</button>
                    </div>
                </div>
                <div class="input-group">
                    <label for="presentationDate">Apresenta√ß√£o (Data):</label>
                    <input type="date" id="presentationDate" value="2025-08-20">
                    <div class="input-actions">
                        <button class="btn btn-primary btn-small" onclick="energyAI.clearField('presentationDate')">Limpar</button>
                        <button class="btn btn-success btn-small" onclick="energyAI.restoreField('presentationDate', '2025-08-20')">Corrigir</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-card">
            <div class="menu-title" onclick="energyAI.toggleMenu('dashboard')">
                <span>üìä Resumo & Medi√ß√µes</span>
                <span class="menu-icon">‚ñ∂</span>
            </div>
            <div class="menu-content" id="dashboard">
                <div class="dashboard">
                    <div class="card meter-reading">
                        <h3>üìä Leitura do Rel√≥gio</h3>
                        <div class="input-group">
                            <label for="meterReading">Leitura Atual (kWh):</label>
                            <input type="number" id="meterReading" value="4131" onchange="energyAI.updateMeterReading()">
                            <div class="input-actions">
                                <button class="btn btn-primary btn-small" onclick="energyAI.clearField('meterReading')">Limpar</button>
                                <button class="btn btn-success btn-small" onclick="energyAI.updateMeterReading()">Corrigir</button>
                            </div>
                        </div>
                        <div class="input-group">
                            <label for="lastMonthReading">Leitura Anterior (kWh):</label>
                            <input type="number" id="lastMonthReading" value="3681" onchange="energyAI.updateMeterReading()">
                            <div class="input-actions">
                                <button class="btn btn-primary btn-small" onclick="energyAI.clearField('lastMonthReading')">Limpar</button>
                                <button class="btn btn-success btn-small" onclick="energyAI.updateMeterReading()">Corrigir</button>
                            </div>
                        </div>
                        <div class="meter-display" id="currentMonth">450 kWh</div>
                        <small>Consumo do m√™s atual</small>
                    </div>
                    <div class="card">
                        <h3>üè∑Ô∏è C√≥digo √önico</h3>
                        <div class="input-group">
                            <label for="uniqueCode">C√≥digo:</label>
                            <input type="text" id="uniqueCode" value="0643046-5">
                            <div class="input-actions">
                                <button class="btn btn-primary btn-small" onclick="energyAI.clearField('uniqueCode')">Limpar</button>
                                <button class="btn btn-success btn-small" onclick="energyAI.restoreField('uniqueCode', '0643046-5')">Corrigir</button>
                            </div>
                        </div>
                        <small>N√∫mero para refer√™ncia e pagamento.</small>
                    </div>
                    
                    <div class="card">
                        <h3>üí∞ Tarifas AME - Manaus</h3>
                        <div class="tariff-info">
                            <div class="tariff-row">
                                <span><strong>Residencial Normal:</strong></span>
                                <span>R$ 0,902464/kWh</span>
                            </div>
                            <div class="tariff-row">
                                <span>Taxa de Ilumina√ß√£o:</span>
                                <span>R$ 32,00</span>
                            </div>
                            <div class="tariff-row">
                                <span>ICMS (at√© 50 kWh):</span>
                                <span>12%</span>
                            </div>
                            <div class="tariff-row">
                                <span>ICMS (> 50 kWh):</span>
                                <span>25%</span>
                            </div>
                            <div class="tariff-row">
                                <span><strong>Bandeira Atual:</strong></span>
                                <span id="currentFlag">Vermelha Patamar II (+R$ 0,07877/kWh)</span>
                                <select id="bandeiraSelect" onchange="energyAI.updateBandeira()">
                                    <option value="verde">Verde</option>
                                    <option value="amarela">Amarela</option>
                                    <option value="vermelha1">Vermelha Patamar I</option>
                                    <option value="vermelha2" selected>Vermelha Patamar II</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="card section-card">
                        <h3>üí° Resumo de Custos - M√™s Atual</h3>
                        <div class="cost-breakdown">
                            <div class="cost-item">
                                <div class="cost-value" id="totalKwh">450</div>
                                <div>kWh Consumidos</div>
                            </div>
                            <div class="cost-item">
                                <div class="cost-value" id="energyCost">R$ 406,10</div>
                                <div>Custo Energia</div>
                            </div>
                            <div class="cost-item">
                                <div class="cost-value" id="taxesCost">R$ 211,79</div>
                                <div>Impostos/Taxas</div>
                            </div>
                            <div class="cost-item">
                                <div class="cost-value" id="totalCost">R$ 617,89</div>
                                <div>Total da Conta</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card section-card">
                        <h3>üí∞ Detalhamento de Tributos</h3>
                        <div class="tariff-row" style="font-weight: bold;">
                            <span>Tributo</span>
                            <span>Base (R$)</span>
                            <span>Al√≠quota (%)</span>
                            <span>Valor (R$)</span>
                            <span>A√ß√µes</span>
                        </div>
                        <div class="tariff-row">
                            <span>ICMS</span>
                            <input type="text" id="icmsBase" value="388,57" style="width: 80px; text-align: right;">
                            <input type="text" id="icmsAliquota" value="0,00" style="width: 60px; text-align: right;">
                            <input type="text" id="icmsValor" value="0,00" style="width: 60px; text-align: right;">
                            <div class="input-actions" style="margin-top: 0;">
                                <button class="btn btn-primary btn-small" onclick="energyAI.clearTributo('icms')">Limpar</button>
                                <button class="btn btn-success btn-small" onclick="energyAI.restoreTributo('icms')">Corrigir</button>
                            </div>
                        </div>
                        <div class="tariff-row">
                            <span>PIS</span>
                            <input type="text" id="pisBase" value="0,00" style="width: 80px; text-align: right;">
                            <input type="text" id="pisAliquota" value="0,60" style="width: 60px; text-align: right;">
                            <input type="text" id="pisValor" value="2,33" style="width: 60px; text-align: right;">
                            <div class="input-actions" style="margin-top: 0;">
                                <button class="btn btn-primary btn-small" onclick="energyAI.clearTributo('pis')">Limpar</button>
                                <button class="btn btn-success btn-small" onclick="energyAI.restoreTributo('pis')">Corrigir</button>
                            </div>
                        </div>
                        <div class="tariff-row">
                            <span>COFINS</span>
                            <input type="text" id="cofinsBase" value="0,00" style="width: 80px; text-align: right;">
                            <input type="text" id="cofinsAliquota" value="4,90" style="width: 60px; text-align: right;">
                            <input type="text" id="cofinsValor" value="18,97" style="width: 60px; text-align: right;">
                            <div class="input-actions" style="margin-top: 0;">
                                <button class="btn btn-primary btn-small" onclick="energyAI.clearTributo('cofins')">Limpar</button>
                                <button class="btn btn-success btn-small" onclick="energyAI.restoreTributo('cofins')">Corrigir</button>
                            </div>
                        </div>
                    </div>

                    <div class="card section-card">
                        <h3>üö¶ Bandeira Tarif√°ria</h3>
                        <div id="bandeira-list">
                            <div class="tariff-row" style="font-weight: bold;">
                                <span>M√™s/Ano</span>
                                <span>Bandeira Tarif√°ria</span>
                                <span>R$/kWh</span>
                                <span>A√ß√µes</span>
                            </div>
                            <div class="tariff-row">
                                <span>07/2025</span>
                                <span>Vermelha Patamar II</span>
                                <span>0,04463</span>
                                <span><button class="btn btn-danger btn-small" onclick="energyAI.removeBandeira('07/2025')">Remover</button></span>
                            </div>
                            <div class="tariff-row">
                                <span>08/2025</span>
                                <span>Vermelha Patamar II</span>
                                <span>0,07877</span>
                                <span><button class="btn btn-danger btn-small" onclick="energyAI.removeBandeira('08/2025')">Remover</button></span>
                            </div>
                        </div>
                        <div style="margin-top: 15px; display: flex; align-items: center; gap: 5px;">
                            <input type="text" id="newBandeiraMonth" placeholder="M√™s/Ano" style="width: 90px;">
                            <select id="newBandeiraType" style="width: 140px;">
                                <option value="verde">Verde</option>
                                <option value="amarela">Amarela</option>
                                <option value="vermelha1">Vermelha I</option>
                                <option value="vermelha2">Vermelha II</option>
                            </select>
                            <input type="number" id="newBandeiraValue" placeholder="R$/kWh" step="0.00001" style="width: 90px;">
                            <button class="btn btn-primary" onclick="energyAI.addBandeira()">Adicionar</button>
                        </div>
                    </div>

                    <div class="card section-card">
                        <h3>üìÉ Descri√ß√£o da Conta</h3>
                        <div class="input-group">
                            <label for="itensFatura">Itens da Fatura:</label>
                            <textarea id="itensFatura" rows="10">Consumo: 450 kWh a 0,902464 = R$ 406,10
Contribui√ß√£o de Ilumina√ß√£o P√∫blica (COSIP) = R$ 32,00
Desc. Bandeira Verde (base 388,57) = -R$ 32,82
Adicional Bandeira Vermelha Patamar 2 = R$ 15,35
Parcelamento Cosip 1/36 = R$ 10,13
Juros de Mora Importe/Servi√ßo 07/25-04 = R$ 0,04
Desc. s/Multa/Juros Parcelam. = R$ -2,43
Desc. s/Juros Parcelam.Especial 1/36 = R$ -6,43
PIS (0,60%) = R$ 2,33
COFINS (4,90%) = R$ 18,97
Total a pagar = R$ 617,89</textarea>
                        </div>
                    </div>
                    
                    <div class="card section-card">
                        <h3>‚òÄÔ∏è Acompanhamento Di√°rio do Consumo</h3>
                        <div class="input-group grid-2col">
                            <div>
                                <label for="dailyStartReading">Leitura Inicial (kWh):</label>
                                <input type="number" id="dailyStartReading" value="4131" onchange="energyAI.updateDailyConsumption()">
                            </div>
                            <div>
                                <label for="dailyEndReading">Leitura Final (kWh):</label>
                                <input type="number" id="dailyEndReading" value="" onchange="energyAI.updateDailyConsumption()">
                            </div>
                        </div>
                        <div class="tariff-row">
                            <span>Consumo Di√°rio:</span>
                            <span id="dailyConsumptionKwh">0 kWh</span>
                        </div>
                        <div class="tariff-row">
                            <span>Custo Di√°rio Estimado:</span>
                            <span id="dailyCostEstimate">R$ 0,00</span>
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button class="btn btn-success" onclick="energyAI.addDailyRecord()">Registrar Leitura Di√°ria</button>
                            <button class="btn btn-danger" onclick="energyAI.resetDailyRecords()">Limpar Hist√≥rico</button>
                        </div>
                        <div id="dailyRecords" style="margin-top: 20px;">
                            <h4>Hist√≥rico:</h4>
                            <div class="tariff-row" style="font-weight: bold; border-bottom: 2px solid #ccc;">
                                <span>Data</span>
                                <span>Consumo (kWh)</span>
                                <span>Custo (R$)</span>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3>üìà Consumo Instant√¢neo</h3>
                        <div class="meter-display" style="color: #FF6B35;" id="instantPower">2.84 kW</div>
                        <div style="margin: 15px 0;">
                            <strong>Custo por hora:</strong> R$ <span id="hourCost">2,02</span>
                        </div>
                        <div>
                            <strong>Proje√ß√£o di√°ria:</strong> R$ <span id="dailyProjection">48,48</span>
                        </div>
                    </div>
                    <div class="card">
                        <h3>‚ö° Consumo por Disjuntor (Circuito)</h3>
                        <div id="circuitsGrid">
                            </div>
                        <small style="color: #666;">(Baseado nos aparelhos LIGADOS)</small>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-card">
            <div class="menu-title" onclick="energyAI.toggleMenu('devices')">
                <span>üîå Meus Aparelhos El√©tricos</span>
                <span class="menu-icon">‚ñ∂</span>
            </div>
            <div class="menu-content" id="devices">
                <button class="btn btn-primary" style="margin-bottom: 20px;" onclick="energyAI.showAddDeviceModal()">+ Adicionar Novo Aparelho</button>
                <div class="device-grid" id="deviceGrid">
                </div>
            </div>
        </div>
        
        <div class="section-card">
            <div class="menu-title" onclick="energyAI.toggleMenu('recommendations')">
                <span>ü§ñ An√°lise IA & Recomenda√ß√µes</span>
                <span class="menu-icon">‚ñ∂</span>
            </div>
            <div class="menu-content" id="recommendations">
                <div id="recommendationsList">
                </div>
            </div>
        </div>

        <button class="btn btn-success" style="margin: 20px;" onclick="energyAI.generatePDF()">Gerar Relat√≥rio em PDF</button>

    </div>

    <div id="deviceModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000; justify-content:center; align-items:center;">
        <div style="background:white; padding:30px; border-radius:15px; width:90%; max-width:500px; box-shadow:0 5px 20px rgba(0,0,0,0.3);">
            <h3 id="modalTitle">Adicionar Aparelho</h3>
            <div class="input-group">
                <label for="deviceName">Nome do Aparelho:</label>
                <input type="text" id="deviceName" placeholder="Ex: Ar Condicionado Sala">
            </div>
            <div class="input-group">
                <label for="devicePower">Pot√™ncia (Watts):</label>
                <input type="number" id="devicePower" placeholder="1200">
            </div>
            <div class="input-group">
                <label for="deviceHours">Horas de Uso por Dia:</label>
                <input type="number" id="deviceHours" step="0.5" placeholder="8">
            </div>
            <div class="input-group">
                <label for="deviceIcon">√çcone (Emoji):</label>
                <input type="text" id="deviceIcon" placeholder="‚ùÑÔ∏è">
            </div>
            <div class="input-group">
                <label for="deviceCategory">Categoria:</label>
                <input type="text" id="deviceCategory" placeholder="climatiza√ß√£o">
            </div>
            <button class="btn btn-success" id="saveDeviceBtn">Salvar Aparelho</button>
            <button class="btn btn-danger" onclick="document.getElementById('deviceModal').style.display='none'">Cancelar</button>
        </div>
    </div>

    <script>
        const { jsPDF } = window.jspdf;
        class EnergyOptimizationAI {
            constructor() {
                this.meterReading = 4131;
                this.lastMonthReading = 3681;
                this.currentMonthConsumption = 450;
                this.dailyRecords = [];

                this.tariffs = {
                    residential: 0.902464,
                    publicLighting: 32.00,
                    bandeira: {
                        verde: 0.00,
                        amarela: 0.01343,
                        vermelha1: 0.04463,
                        vermelha2: 0.07877
                    }
                };
                this.currentBandeira = 'vermelha2';
                this.bandeiraHistory = [
                    { month: '07/2025', type: 'vermelha2', value: 0.04463 },
                    { month: '08/2025', type: 'vermelha2', value: 0.07877 }
                ];
                this.tributoDefaults = {
                    icms: { base: '388,57', aliquota: '0,00', valor: '0,00' },
                    pis: { base: '0,00', aliquota: '0,60', valor: '2,33' },
                    cofins: { base: '0,00', aliquota: '4,90', valor: '18,97' }
                };
                
                this.devices = [
                    { id: 1, name: 'Ar Condicionado Split', icon: '‚ùÑÔ∏è', power: 1200, hoursPerDay: 8, status: 'on', category: 'climatiza√ß√£o' },
                    { id: 2, name: 'Geladeira Frost Free', icon: 'üßä', power: 150, hoursPerDay: 24, status: 'on', category: 'refrigera√ß√£o' },
                    { id: 3, name: 'Chuveiro El√©trico', icon: 'üöø', power: 3200, hoursPerDay: 1, status: 'off', category: 'aquecimento' },
                    { id: 4, name: 'TV LED 55"', icon: 'üì∫', power: 180, hoursPerDay: 6, status: 'on', category: 'eletr√¥nicos' },
                    { id: 5, name: 'M√°quina de Lavar', icon: 'üëï', power: 800, hoursPerDay: 1.5, status: 'off', category: 'eletrodom√©sticos' },
                    { id: 6, name: 'Ilumina√ß√£o LED', icon: 'üí°', power: 80, hoursPerDay: 8, status: 'on', category: 'ilumina√ß√£o' },
                    { id: 7, name: 'Micro-ondas', icon: 'üî•', power: 1000, hoursPerDay: 0.5, status: 'off', category: 'cozinha' },
                    { id: 8, name: 'Ventilador de Teto', icon: 'üåÄ', power: 60, hoursPerDay: 12, status: 'on', category: 'climatiza√ß√£o' }
                ];
                
                this.init();
            }

            init() {
                this.renderDevices();
                this.updateAllCalculations();
                this.generateRecommendations();
                this.setInitialBandeira();
                this.renderBandeiraHistory();
                this.startRealTimeUpdates();
            }
            
            toggleMenu(id) {
                const menuContent = document.getElementById(id);
                const menuTitle = menuContent.previousElementSibling;
                if (menuContent.style.display === 'block') {
                    menuContent.style.display = 'none';
                    menuTitle.classList.remove('active');
                } else {
                    menuContent.style.display = 'block';
                    menuTitle.classList.add('active');
                }
            }

            clearField(id) {
                document.getElementById(id).value = '';
            }

            restoreField(id, originalValue) {
                document.getElementById(id).value = originalValue;
            }

            clearTributo(tributo) {
                document.getElementById(`${tributo}Base`).value = '';
                document.getElementById(`${tributo}Aliquota`).value = '';
                document.getElementById(`${tributo}Valor`).value = '';
            }

            restoreTributo(tributo) {
                document.getElementById(`${tributo}Base`).value = this.tributoDefaults[tributo].base;
                document.getElementById(`${tributo}Aliquota`).value = this.tributoDefaults[tributo].aliquota;
                document.getElementById(`${tributo}Valor`).value = this.tributoDefaults[tributo].valor;
            }

            setInitialBandeira() {
                const bandeiraSelect = document.getElementById('bandeiraSelect');
                bandeiraSelect.value = this.currentBandeira;
            }

            updateBandeira() {
                const bandeiraSelect = document.getElementById('bandeiraSelect');
                this.currentBandeira = bandeiraSelect.value;
                const flagNames = {
                    verde: 'Verde (R$ 0,00)',
                    amarela: 'Amarela (+R$ 0,01343/kWh)',
                    vermelha1: 'Vermelha Patamar I (+R$ 0,04463/kWh)',
                    vermelha2: 'Vermelha Patamar II (+R$ 0,07877/kWh)'
                };
                document.getElementById('currentFlag').textContent = flagNames[this.currentBandeira];
                this.updateAllCalculations();
            }

            updateMeterReading() {
                const meterInput = document.getElementById('meterReading');
                const lastMonthInput = document.getElementById('lastMonthReading');
                
                this.meterReading = parseInt(meterInput.value) || this.meterReading;
                this.lastMonthReading = parseInt(lastMonthInput.value) || this.lastMonthReading;

                this.currentMonthConsumption = this.meterReading - this.lastMonthReading;
                document.getElementById('currentMonth').textContent = `${this.currentMonthConsumption} kWh`;
                this.updateAllCalculations();
            }
            
            updateDailyConsumption() {
                const startReading = parseFloat(document.getElementById('dailyStartReading').value);
                const endReading = parseFloat(document.getElementById('dailyEndReading').value);
                if (startReading && endReading && endReading >= startReading) {
                    const dailyConsumption = endReading - startReading;
                    document.getElementById('dailyConsumptionKwh').textContent = `${dailyConsumption.toFixed(2)} kWh`;
                    const dailyCost = dailyConsumption * this.tariffs.residential + (dailyConsumption * this.tariffs.bandeira[this.currentBandeira]);
                    document.getElementById('dailyCostEstimate').textContent = `R$ ${dailyCost.toFixed(2)}`;
                } else {
                    document.getElementById('dailyConsumptionKwh').textContent = `0 kWh`;
                    document.getElementById('dailyCostEstimate').textContent = `R$ 0,00`;
                }
            }

            addDailyRecord() {
                const startReading = parseFloat(document.getElementById('dailyStartReading').value);
                const endReading = parseFloat(document.getElementById('dailyEndReading').value);
                if (startReading && endReading && endReading >= startReading) {
                    const dailyConsumption = endReading - startReading;
                    const dailyCost = dailyConsumption * this.tariffs.residential + (dailyConsumption * this.tariffs.bandeira[this.currentBandeira]);
                    const today = new Date().toLocaleDateString('pt-BR');
                    this.dailyRecords.push({ date: today, kwh: dailyConsumption, cost: dailyCost });
                    
                    this.renderDailyRecords();

                    document.getElementById('dailyStartReading').value = endReading;
                    document.getElementById('dailyEndReading').value = '';
                    this.updateDailyConsumption();
                } else {
                    alert('Por favor, insira leituras v√°lidas para o in√≠cio e fim do dia.');
                }
            }

            resetDailyRecords() {
                this.dailyRecords = [];
                this.renderDailyRecords();
            }

            renderDailyRecords() {
                const recordsList = document.getElementById('dailyRecords');
                recordsList.innerHTML = `
                    <h4>Hist√≥rico:</h4>
                    <div class="tariff-row" style="font-weight: bold; border-bottom: 2px solid #ccc;">
                        <span>Data</span>
                        <span>Consumo (kWh)</span>
                        <span>Custo (R$)</span>
                    </div>
                `;
                this.dailyRecords.forEach(record => {
                    const newRecordDiv = document.createElement('div');
                    newRecordDiv.className = 'daily-record';
                    newRecordDiv.innerHTML = `
                        <span>${record.date}</span>
                        <span>${record.kwh.toFixed(2)} kWh</span>
                        <span>R$ ${record.cost.toFixed(2)}</span>
                    `;
                    recordsList.appendChild(newRecordDiv);
                });
            }
            
            removeBandeira(month) {
                this.bandeiraHistory = this.bandeiraHistory.filter(b => b.month !== month);
                this.renderBandeiraHistory();
            }

            addBandeira() {
                const monthInput = document.getElementById('newBandeiraMonth').value;
                const typeInput = document.getElementById('newBandeiraType').value;
                const valueInput = document.getElementById('newBandeiraValue').value;

                if (!monthInput || !typeInput) {
                    alert('Por favor, preencha o m√™s/ano e selecione a bandeira.');
                    return;
                }

                let bandeiraValue;
                if (valueInput !== '') {
                    bandeiraValue = parseFloat(valueInput);
                } else {
                    bandeiraValue = this.tariffs.bandeira[typeInput];
                }

                const newBandeira = {
                    month: monthInput,
                    type: typeInput,
                    value: bandeiraValue
                };
                this.bandeiraHistory.push(newBandeira);
                this.renderBandeiraHistory();
                
                document.getElementById('newBandeiraMonth').value = '';
                document.getElementById('newBandeiraType').value = 'verde';
                document.getElementById('newBandeiraValue').value = '';
            }

            renderBandeiraHistory() {
                const bandeiraList = document.getElementById('bandeira-list');
                bandeiraList.innerHTML = `
                    <div class="tariff-row" style="font-weight: bold;">
                        <span>M√™s/Ano</span>
                        <span>Bandeira Tarif√°ria</span>
                        <span>R$/kWh</span>
                        <span>A√ß√µes</span>
                    </div>
                `;
                this.bandeiraHistory.forEach(b => {
                    const row = document.createElement('div');
                    row.className = 'tariff-row';
                    const bandeiraText = {
                        verde: 'Verde', amarela: 'Amarela', vermelha1: 'Vermelha Patamar I', vermelha2: 'Vermelha Patamar II'
                    };
                    row.innerHTML = `
                        <span>${b.month}</span>
                        <span>${bandeiraText[b.type]}</span>
                        <span>${b.value.toFixed(5)}</span>
                        <span><button class="btn btn-danger btn-small" onclick="energyAI.removeBandeira('${b.month}')">Remover</button></span>
                    `;
                    bandeiraList.appendChild(row);
                });
            }

            renderDevices() {
                const grid = document.getElementById('deviceGrid');
                grid.innerHTML = '';
                this.devices.forEach(device => {
                    const deviceCard = this.createDeviceCard(device);
                    grid.appendChild(deviceCard);
                });
            }

            createDeviceCard(device) {
                const dailyConsumption = (device.power * device.hoursPerDay) / 1000;
                const monthlyConsumption = dailyConsumption * 30;
                const dailyCost = this.calculateInstantCost(dailyConsumption);
                const monthlyCost = this.calculateInstantCost(monthlyConsumption);
                const card = document.createElement('div');
                card.className = 'device-card';
                card.innerHTML = `
                    <div class="device-header">
                        <div class="device-info">
                            <span class="device-icon">${device.icon}</span>
                            <div class="device-details">
                                <div class="device-name">${device.name}</div>
                                <div class="device-specs">
                                    ${device.power}W √ó ${device.hoursPerDay}h/dia
                                </div>
                            </div>
                        </div>
                        <span class="device-status status-${device.status}" onclick="energyAI.toggleDevice(${device.id})">
                            ${device.status === 'on' ? 'LIGADO' : 'DESLIGADO'}
                        </span>
                    </div>
                    <div class="cost-display">
                        <div class="daily-cost">R$ ${dailyCost.toFixed(2)}/dia</div>
                        <div class="monthly-cost">~R$ ${monthlyCost.toFixed(2)}/m√™s</div>
                        <div style="margin-top: 5px; font-size: 0.9rem; color: #666;">
                            ${dailyConsumption.toFixed(2)} kWh/dia | ${monthlyConsumption.toFixed(1)} kWh/m√™s
                        </div>
                    </div>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-primary" onclick="energyAI.optimizeDevice(${device.id})">Otimizar</button>
                        <button class="btn" style="background: #2196F3;" onclick="energyAI.showAddDeviceModal(${device.id})">Editar</button>
                        <button class="btn btn-danger" onclick="energyAI.removeDevice(${device.id})">Remover</button>
                    </div>
                `;
                return card;
            }

            showAddDeviceModal(deviceId = null) {
                const modal = document.getElementById('deviceModal');
                const modalTitle = document.getElementById('modalTitle');
                const saveBtn = document.getElementById('saveDeviceBtn');
                
                if (deviceId) {
                    const device = this.devices.find(d => d.id === deviceId);
                    if (!device) return;
                    modalTitle.textContent = 'Editar Aparelho';
                    document.getElementById('deviceName').value = device.name;
                    document.getElementById('devicePower').value = device.power;
                    document.getElementById('deviceHours').value = device.hoursPerDay;
                    document.getElementById('deviceIcon').value = device.icon;
                    document.getElementById('deviceCategory').value = device.category;
                    saveBtn.onclick = () => this.saveDevice(deviceId);
                } else {
                    modalTitle.textContent = 'Adicionar Aparelho';
                    document.getElementById('deviceName').value = '';
                    document.getElementById('devicePower').value = '';
                    document.getElementById('deviceHours').value = '';
                    document.getElementById('deviceIcon').value = '';
                    document.getElementById('deviceCategory').value = '';
                    saveBtn.onclick = () => this.saveDevice(null);
                }
                modal.style.display = 'flex';
            }

            saveDevice(deviceId) {
                const name = document.getElementById('deviceName').value;
                const power = parseInt(document.getElementById('devicePower').value);
                const hours = parseFloat(document.getElementById('deviceHours').value);
                const icon = document.getElementById('deviceIcon').value;
                const category = document.getElementById('deviceCategory').value;

                if (!name || isNaN(power) || isNaN(hours)) {
                    alert('Por favor, preencha todos os campos corretamente.');
                    return;
                }

                if (deviceId) {
                    const device = this.devices.find(d => d.id === deviceId);
                    if (device) {
                        device.name = name;
                        device.power = power;
                        device.hoursPerDay = hours;
                        device.icon = icon;
                        device.category = category;
                    }
                } else {
                    const newId = this.devices.length > 0 ? Math.max(...this.devices.map(d => d.id)) + 1 : 1;
                    this.devices.push({
                        id: newId,
                        name: name,
                        icon: icon,
                        power: power,
                        hoursPerDay: hours,
                        status: 'on',
                        category: category
                    });
                }

                document.getElementById('deviceModal').style.display = 'none';
                this.renderDevices();
                this.updateAllCalculations();
            }

            removeDevice(deviceId) {
                if (confirm('Tem certeza que deseja remover este aparelho?')) {
                    this.devices = this.devices.filter(d => d.id !== deviceId);
                    this.renderDevices();
                    this.updateAllCalculations();
                }
            }
            
            toggleDevice(deviceId) {
                const device = this.devices.find(d => d.id === deviceId);
                if (device) {
                    device.status = device.status === 'on' ? 'off' : 'on';
                    this.renderDevices();
                    this.updateAllCalculations();
                }
            }

            optimizeDevice(deviceId) {
                const device = this.devices.find(d => d.id === deviceId);
                if (device) {
                    if (device.category === 'climatiza√ß√£o') {
                        device.hoursPerDay = Math.max(6, device.hoursPerDay * 0.8);
                        this.addRecommendation(`‚ùÑÔ∏è ${device.name}: Reduzido para ${device.hoursPerDay}h/dia considerando clima de Manaus`);
                    } else if (device.category === 'aquecimento') {
                        device.hoursPerDay = Math.max(0.5, device.hoursPerDay * 0.7);
                        this.addRecommendation(`üöø ${device.name}: Tempo reduzido para ${device.hoursPerDay}h devido ao clima quente`);
                    } else {
                        device.hoursPerDay = Math.max(0.5, device.hoursPerDay * 0.9);
                        this.addRecommendation(`‚ö° ${device.name}: Uso otimizado para ${device.hoursPerDay}h/dia`);
                    }
                    this.renderDevices();
                    this.updateAllCalculations();
                }
            }

            calculateInstantCost(kwh) {
                return kwh * this.tariffs.residential + (kwh * this.tariffs.bandeira[this.currentBandeira]);
            }

            updateAllCalculations() {
                let instantPower = 0;
                this.devices.forEach(device => {
                    if (device.status === 'on') {
                        instantPower += device.power;
                    }
                });
                document.getElementById('instantPower').textContent = `${(instantPower / 1000).toFixed(2)} kW`;
                document.getElementById('hourCost').textContent = (this.calculateInstantCost(instantPower / 1000)).toFixed(2);
                document.getElementById('dailyProjection').textContent = (this.calculateInstantCost(instantPower / 1000) * 24).toFixed(2);

                this.currentMonthConsumption = this.meterReading - this.lastMonthReading;
                document.getElementById('totalKwh').textContent = this.currentMonthConsumption;
                
                const energyCost = 406.10;
                const taxesCost = 211.79;
                const totalCost = energyCost + taxesCost;

                document.getElementById('energyCost').textContent = `R$ ${energyCost.toFixed(2)}`;
                document.getElementById('taxesCost').textContent = `R$ ${taxesCost.toFixed(2)}`;
                document.getElementById('totalCost').textContent = `R$ ${totalCost.toFixed(2)}`;

                this.renderCircuits();
                this.updateDailyConsumption();
            }

            renderCircuits() {
                const circuits = {
                    'Climatiza√ß√£o': ['Ar Condicionado', 'Ventilador'],
                    'Aquecimento': ['Chuveiro'],
                    'Cozinha': ['Geladeira', 'Micro-ondas'],
                    'Eletr√¥nicos': ['TV', 'Ilumina√ß√£o']
                };
                const circuitConsumption = {};

                this.devices.forEach(device => {
                    let circuitName = 'Outros';
                    for (const [name, keywords] of Object.entries(circuits)) {
                        if (keywords.some(keyword => device.name.includes(keyword))) {
                            circuitName = name;
                            break;
                        }
                    }
                    if (device.status === 'on') {
                        circuitConsumption[circuitName] = (circuitConsumption[circuitName] || 0) + device.power;
                    }
                });

                const circuitsGrid = document.getElementById('circuitsGrid');
                circuitsGrid.innerHTML = '';
                for (const [name, power] of Object.entries(circuitConsumption)) {
                    const row = document.createElement('div');
                    row.className = 'tariff-row';
                    row.style.marginBottom = '5px';
                    row.innerHTML = `
                        <span>${name}</span>
                        <span style="font-weight: bold;">${(power / 1000).toFixed(2)} kW</span>
                    `;
                    circuitsGrid.appendChild(row);
                }
            }

            generateRecommendations() {
                const recommendations = [];
                if (this.currentMonthConsumption > 350) {
                    recommendations.push('üö® Fatura alta detectada! Seu consumo de 450 kWh √© muito elevado para uma resid√™ncia. Foco em reduzir.');
                }
                const acDevice = this.devices.find(d => d.category === 'climatiza√ß√£o' && d.name.includes('Ar'));
                if (acDevice && acDevice.status === 'on' && acDevice.hoursPerDay > 8) {
                    recommendations.push('üå°Ô∏è Em Manaus, o Ar Condicionado √© o maior vil√£o! Reduza o tempo de uso para no m√°ximo 6-8 horas por dia.');
                }
                const highConsumptionDevices = this.devices.filter(d => d.status === 'on' && (d.power * d.hoursPerDay) / 1000 > 5);
                if (highConsumptionDevices.length > 0) {
                    highConsumptionDevices.forEach(device => {
                        recommendations.push(`üî• Aten√ß√£o! O aparelho "${device.name}" √© um dos que mais consomem. Considere reduzir seu uso ou troc√°-lo por um modelo mais eficiente.`);
                    });
                }
                recommendations.push('üí° Verifique se n√£o h√° vazamentos de energia (aparelhos em stand-by) e se todos os eletrodom√©sticos est√£o em boas condi√ß√µes.');
                recommendations.push('üìä A bandeira tarif√°ria Vermelha Patamar II encarece muito a conta. O foco deve ser na redu√ß√£o total do consumo para evitar essa tarifa.');
                recommendations.push('‚òÄÔ∏è Considere a instala√ß√£o de pain√©is solares para economizar at√© 80% da sua conta a longo prazo. O sol de Manaus √© um grande aliado!');
                this.renderRecommendations(recommendations);
            }

            renderRecommendations(recommendations) {
                const list = document.getElementById('recommendationsList');
                list.innerHTML = '';
                recommendations.forEach(rec => {
                    const item = document.createElement('div');
                    item.className = rec.includes('üö®') || rec.includes('Aten√ß√£o') ? 'recommendation-item high-consumption' : 'recommendation-item';
                    item.textContent = rec;
                    list.appendChild(item);
                });
            }

            addRecommendation(text) {
                const list = document.getElementById('recommendationsList');
                const item = document.createElement('div');
                item.className = 'recommendation-item';
                item.textContent = text;
                list.insertBefore(item, list.firstChild);
            }

            startRealTimeUpdates() {
                setInterval(() => {
                    this.updateAllCalculations();
                }, 5000);
                setInterval(() => {
                    this.generateRecommendations();
                }, 30000);
            }

            generatePDF() {
                const doc = new jsPDF('p', 'pt', 'a4');
                const content = document.getElementById('content-to-pdf');
                
                html2canvas(content, {
                    scale: 2
                }).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    const imgWidth = 595.28;
                    const pageHeight = 841.89;
                    const imgHeight = canvas.height * imgWidth / canvas.width;
                    let heightLeft = imgHeight;
                    let position = 0;
                    
                    doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                    
                    while (heightLeft >= 0) {
                        position = heightLeft - imgHeight;
                        doc.addPage();
                        doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;
                    }
                    doc.save('relatorio_energyai.pdf');
                });
            }
        }
        const energyAI = new EnergyOptimizationAI();
    </script>
</body>
</html>
